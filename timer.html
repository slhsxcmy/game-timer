<html>
  <head>
    <style>
      body {
        margin: 0;
        width: 100vw;
        height: 100vh;
        background-color: aquamarine;
        display: flex;
        flex-direction: column;
      }

      body,
      input,
      button {
        font-size: 30px;
      }

      .tile {
        width: 100%;
        height: 100%;
        background-color: bisque;
        font-size: 100px;
        font-weight: bold;
      }

      #tiles {
        flex: 1;
        display: grid;
        grid-template-columns: 1fr 1fr;
        @media (max-width: 1000px) {
          grid-template-columns: 1fr;
        }
      }
    </style>
    <script>
      let times = [];
      let curPlayer = -1;

      let numPlayers = -1;
      let initial = -1;
      let increment = -1;

      let interval = -1;

      function format(n) {
        return `${n < 0 ? "-" : ""}${Math.floor(Math.abs(n) / 60)
          .toFixed(0)
          .padStart(2, "0")}:${String(Math.abs(n) % 60).padStart(2, "0")}`;
      }

      function startTimer() {
        curPlayer = 0;
        numPlayers = Number(document.querySelector("#num_players").value);
        initial = Number(document.querySelector("#time_initial").value);
        increment = Number(document.querySelector("#time_increment").value);
        times = Array.from({ length: numPlayers }).fill(initial);
        clearInterval(interval);
        document.querySelector("#tiles").innerHTML = "";

        Array.from({ length: numPlayers }).forEach((_, index) => {
          let node = document.createElement("button");
          node.innerText = format(times[index]);
          document.querySelector("#tiles").appendChild(node);
          node.className = "tile";
          node.onclick = function () {
            if (index === curPlayer) {
              times[index] += increment;
              node.innerText = format(times[index]);
              curPlayer = (index + 1) % numPlayers;
            }
          };
        });

        interval = setInterval(() => {
          times[curPlayer] -= 1;
          document.querySelectorAll(".tile")[curPlayer].innerText = format(
            times[curPlayer]
          );
        }, 1000);
      }
    </script>
  </head>
  <body>
    <div>
      <div>
        <label for="num_players">Number of players</label>
        <input id="num_players" type="number" value="3" />
      </div>
      <div>
        <label for="time_initial">Initial time in seconds</label>
        <input id="time_initial" type="number" value="1800" />
      </div>
      <div>
        <label for="time_increment">Increment in seconds</label>
        <input id="time_increment" type="number" value="60" />
      </div>

      <button onclick="startTimer()">Start</button>
    </div>
    <div id="tiles"></div>
  </body>
</html>
